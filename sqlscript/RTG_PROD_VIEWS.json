{
	"name": "RTG_PROD_VIEWS",
	"properties": {
		"content": {
			"query": "create or Alter view rtg_ecevents\nas\nselect *\nFROM\n    OPENROWSET(\n        BULK 'gold/rtg_ecevents',\n        data_source = 'malta',\n        FORMAT = 'DELTA'\n    ) AS [rtg_ecevents];\n\ncreate or Alter view rtg_moves\nas\nselect *\nFROM\n    OPENROWSET(\n        BULK 'gold/rtg_moves',\n        data_source = 'malta',\n        FORMAT = 'DELTA'\n    ) AS [rtg_moves];\n\ncreate or Alter view rtg_productivity\nas\nselect *\nFROM\n    OPENROWSET(\n        BULK 'gold/rtg_productivity',\n        data_source = 'malta',\n        FORMAT = 'DELTA'\n    ) AS [rtg_productivity];\n\nSELECT rtg.*, (rtg.total_workhours/rtg.total_moves) as rtg_prod\nFROM\n    (SELECT \n        -- [ShiftDateName],\n        [Year], [Month],\n        SUM([move_count]) as total_moves\n        ,SUM([rtg_workhours]) as total_workhours\n        FROM [dbo].[rtg_productivity]\n        GROUP BY [Year], [Month] ) as rtg\n        ORDER BY [Year] DESC, [Month] DESC;",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "malta",
				"poolName": "Built-in"
			},
			"resultLimit": -1
		},
		"type": "SqlQuery"
	}
}