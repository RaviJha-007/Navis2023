{
	"name": "eurogatectb",
	"properties": {
		"content": {
			"query": "-- This is auto-generated code \ncreate or alter view  rehandle_rdsc_export\nas\nselect *\nFROM\n    OPENROWSET(\n        BULK 'gold/rehandle_rdsc_export',\n        data_source = 'gpa',\n        FORMAT = 'DELTA'\n    ) AS [rehandle_rdsc_export]   \nwhere t_put is NULL\nand MONTH(t_put)=09\nand DAY(t_put)=25\norder by t_put DESC\n    GROUP by ecEventGkey\n    having count(*)>1\n\nselect   count(mve_gkey),  Requires_Power_Flag, Year,Month, Week\n from moves where Move_Kind='RECV' and Category_Id='EXPRT' and Freight_Kind_Id='FCL'\n group by  Requires_Power_Flag, Year,Month, Week\n order by Week\n\nselect count(mve_gkey),count(DISTINCT mve_gkey)  from rehandle_export where Year=2023 and Move_Kind='LOAD'\n\nselect top 5 *  from moves where move_kind='RDSC' and year=2022\nselect top 20 *  from rehandle_export where Unit_Nbr='BSIU9921765' order by IB_mve_gkey,RNumber  --APHU6563570  AMFU8783903 APHU6563570 ACLU9729899\nselect * from moves where Unit_Nbr ='MRKU7614004' and Category_Id='EXPRT' order by t_put --BSIU9921765 , GMCU3062480 ,'UACU5213095'  GAOU6031329\nselect * from ecevents where unitIdName='MRKU7614004'   order by EcEventTime \nselect * from rehandle_rdsc_export where Unit_Nbr ='ACSU2965389'\norder by Unit_Nbr ,t_put\n-- create view without Year, Month, Week fields to get around nvarchar to int conversion\ncreate or alter view laden_unladen\nAS \nSELECt [Yard_Id]\n,[Carrier_Visit_Key]\n,[Event_Type_Id]\n,[Move_Kind]\n,[From_Location]\n,[To_Location]\n,[Carry_CHE_Id]\n,[Carry_CHE_Kind]\n,[Unladen]\n,[Laden]\n,[Carrier_Name]\n,[Unit_Nbr]\n,[mve_gkey]\n,[Put_CHE_Id]\n,[Put_CHE_Kind]\n,[Fetch_CHE_Id]\n,[Fetch_CHE_Kind]\n,[t_fetch]\n,[t_dispatch]\n,[t_discharge]\n,[pow]\n,[From_Position_Name]\n,[To_Position_Name]\n,[QC_CHE_Id]\n,[QC_CHE_Kind]\n,[t_carry_complete]\n,[t_put]\nFROM\n    OPENROWSET(\n        BULK 'gold/laden_unladen',\n        data_source = 'valencia',\n        FORMAT = 'DELTA'\n    ) AS [laden_unladen] \n\nselect TOP 3 t_put\nFROM\n    OPENROWSET(\n        BULK 'silver/moves',\n        data_source = 'valencia',\n        FORMAT = 'DELTA'\n    ) AS [moves]\norder by  t_put  DESC    \n\nselect TOP 3  EcEventTime\nFROM\n    OPENROWSET(\n        BULK 'silver/ecevents',\n        data_source = 'valencia',\n        FORMAT = 'DELTA'\n    ) AS [ecevents]\norder by  EcEventTime DESC\n\nselect  DISTINCT cheID,cheName,FcyID\nFROM\n    OPENROWSET(\n        BULK 'silver/ecevents',\n        data_source = 'gpa',\n        FORMAT = 'DELTA'\n    ) AS [ecevents] \n    where cheKind='RTG' order by 3,1 \n\nselect  count(*), ecEventGkey\nFROM\n    OPENROWSET(\n        BULK 'silver/ecevents',\n        data_source = 'gpa',\n        FORMAT = 'DELTA'\n    ) AS [ecevents]\ngroup by  ecEventGkey having count(*) > 1   \n\nselect count(*)  from \n  OPENROWSET(\n        BULK 'silver/cranedelays',\n        data_source = 'valencia',\n        FORMAT = 'DELTA'\n    ) AS [cranedelays]\n\nselect * from moves\nwhere week=31\nwhere ecEventGkey<>587\nwhere year=2022 and Month=8\n--where mve_gkey=2147467606\nwhere ecEventGkey=2177318184\nwhere year=2021\nand month =9\n--order by year, month\n\nselect count(*), week,year from truckturntime group by week,year order by year, week\n\nselect top 10 * from  truckturntime  where carrier_Visit_Key IN (3076046590,3076048349, 3076056090, 2940853576,3065675895 )  order by Trk_Yard_Entered_Time\n\n    select distinct cheName from ecevents\n    where cheKind = 'RTG'\n    where unitIdName='HLXU8312630'\n\nselect distinct month(ATA) from vesselvisits    where year(ATA)=2022\n\nselect Top 10* from  qc_idle_time a\nselect  count(*) , month, IDle_time_Range  from  qc_idle_time where month in (11,10) group by month , IDle_time_Range  order by 2 ,3\n\nselect DISTINCT LEN(From_Position_Name) from moves\nwhere event_type_id='UNIT_YARD_SHIFT'\ncreate or alter view moves\nas\nselect *\nfrom openrowset(\n           bulk 'silver/moves',\n           data_source = 'eurogatectb_powerbianalyticsdata_dfs_core_windows_net',\n           FORMAT = 'DELTA'\n    ) as moves",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "cmsa",
				"poolName": "Built-in"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}